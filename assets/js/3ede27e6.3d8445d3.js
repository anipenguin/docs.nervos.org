"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6917],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>m});var a=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=a.createContext({}),s=function(e){var n=a.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=s(e.components);return a.createElement(c.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,c=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=s(t),m=o,b=u["".concat(c,".").concat(m)]||u[m]||d[m]||r;return t?a.createElement(b,i(i({ref:n},p),{},{components:t})):a.createElement(b,i({ref:n},p))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,i=new Array(r);i[0]=u;var l={};for(var c in n)hasOwnProperty.call(n,c)&&(l[c]=n[c]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var s=2;s<r;s++)i[s]=t[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},2959:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>c,default:()=>m,frontMatter:()=>l,metadata:()=>s,toc:()=>d});var a=t(7462),o=t(3366),r=(t(7294),t(3905)),i=["components"],l={id:"mainnet",title:"Run a CKB Node"},c=void 0,s={unversionedId:"basics/guides/mainnet",id:"basics/guides/mainnet",title:"Run a CKB Node",description:"Running a CKB node not only contributes to the robustness and decentralized nature of the network, but also allows you to access data from the blockchain without any third party, which in turn increases your security.",source:"@site/docs/basics/guides/mainnet.md",sourceDirName:"basics/guides",slug:"/basics/guides/mainnet",permalink:"/docs/basics/guides/mainnet",draft:!1,editUrl:"https://github.com/nervosnetwork/docs-new/tree/develop/website/docs/basics/guides/mainnet.md",tags:[],version:"current",frontMatter:{id:"mainnet",title:"Run a CKB Node"},sidebar:"Basics",previous:{title:"Run a CKB Dev Blockchain",permalink:"/docs/basics/guides/devchain"},next:{title:"Run a CKB Testnet Node",permalink:"/docs/basics/guides/testnet"}},p={},d=[{value:"Run a CKB Mainnet Node",id:"run-a-ckb-mainnet-node",level:2},{value:"Run a Public RPC Node",id:"run-a-public-rpc-node",level:2},{value:"RPC Access Control",id:"rpc-access-control",level:3},{value:"Example",id:"example",level:3},{value:"List of Restricted Methods",id:"list-of-restricted-methods",level:3}],u={toc:d};function m(e){var n=e.components,t=(0,o.Z)(e,i);return(0,r.kt)("wrapper",(0,a.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Running a CKB node not only contributes to the robustness and decentralized nature of the network, but also allows you to access data from the blockchain without any third party, which in turn increases your security."),(0,r.kt)("p",null,"To run a node, you need to use the command line. If you have never used it before, you may refer to ",(0,r.kt)("a",{parentName:"p",href:"https://www.google.com/search?q=learn+command+line"},"how to use the command line tool")," to get started on your computer. Although it may seem complicated at first, it is quite simple and following the specific instructions below should allow you to easily run a CKB mainnet node."),(0,r.kt)("h2",{id:"run-a-ckb-mainnet-node"},"Run a CKB Mainnet Node"),(0,r.kt)("p",null,"Step 1: Download the latest CKB binary file from ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/nervosnetwork/ckb/releases"},"CKB releases page on GitHub")," "),(0,r.kt)("p",null,"Step 2:  Unzip and extract the downloaded file to an easily accessible folder. We recommend ",(0,r.kt)("inlineCode",{parentName:"p"},"C:\\ckb")," for Windows and ",(0,r.kt)("inlineCode",{parentName:"p"},"~/Documents")," for Mac."),(0,r.kt)("p",null,"Step 3: Open Terminal on Mac or Command Prompt on Windows."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Mac:")),(0,r.kt)("p",null,"You can open Terminal in two ways: either go to the Applications folder, then open Utilities and double-click on Terminal, or launch Spotlight search by pressing ",(0,r.kt)("inlineCode",{parentName:"p"},"Command - Spacebar")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"Control -Spacebar"),', then type "Terminal" and double-click on the search result. The subsequent steps will be executed in Terminal.'),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Windows:")),(0,r.kt)("p",null,"(If you are familiar with command line in Windows, you can skip this step and open ",(0,r.kt)("inlineCode",{parentName:"p"},"cmd")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"Power Shell")," instead.)"),(0,r.kt)("p",null,"Download and install ",(0,r.kt)("a",{parentName:"p",href:"https://git-scm.com/download/win"},"Git for Windows"),", once the installation is complete, open the Command Prompt."),(0,r.kt)("p",null,"In the Command Prompt window, type the following git command and press Enter:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"git --version\n")),(0,r.kt)("p",null,"This verify Git commands are available and its current version (--version)"),(0,r.kt)("p",null,"Step 4\uff1aCopy and paste the commands below into the Terminal (Mac) or Command Prompt (Windows):"),(0,r.kt)("p",null,"Note: make sure to edit the commands according to your folder names and directory. "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Mac")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cd /Users/(NAME)/Documents/ckb_v0.32.1_x86_64-apple-darwin\n./ckb --version\n./ckb-cli --version\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note"),": If you encounter the error: ",(0,r.kt)("inlineCode",{parentName:"p"},"\u201cckb\u201d cannot be opened because the developer cannot be verified.")," You can temporarily ",(0,r.kt)("a",{parentName:"p",href:"https://support.apple.com/en-us/HT202491"},"override")," your Mac security settings to open it. Go to ",(0,r.kt)("em",{parentName:"p"},"System Settings")," and click on ",(0,r.kt)("em",{parentName:"p"},"Privacy & Security"),"."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Windows")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cd C:/ckb_v0.32.1_x86_64-pc-windows-msvc \nckb --version \nckb-cli --version\n")),(0,r.kt)("details",null,(0,r.kt)("summary",null,"(click here to view response)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"\nckb 0.32.1 (9ebc9ce 2020-05-29)\nckb-cli 0.32.0 (0fc435d 2020-05-22)\n"))),(0,r.kt)("p",null,"Step 5: To run the CKB mainnet node, copy and paste the commands below into Terminal (Mac) / Command Prompt (Windows):"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Initialize the node (run only once)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"ckb init --chain mainnet\n")),(0,r.kt)("details",null,(0,r.kt)("summary",null,"(click here to view response)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"\nWARN: mining feature is disabled because of lacking the block assembler config options\nInitialized CKB directory in /PATH/ckb_v0.32.1_x86_64-apple-darwin\ncreate ckb.toml\ncreate ckb-miner.toml\n"))),(0,r.kt)("p",null,"** Start the node."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"ckb run\n")),(0,r.kt)("details",null,(0,r.kt)("summary",null,"(click here to view response)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'\n2020-06-05 18:10:19.785 +08:00 main INFO sentry  sentry is disabled\n2020-06-05 18:10:19.869 +08:00 main INFO main  Miner is disabled, edit ckb.toml to enable it\n2020-06-05 18:10:19.942 +08:00 main INFO ckb-memory-tracker  track current process: unsupported\n2020-06-05 18:10:19.942 +08:00 main INFO main  ckb version: 0.32.1 (9ebc9ce 2020-05-29)\n2020-06-05 18:10:19.942 +08:00 main INFO main  chain genesis hash: 0x92b197aa1fba0f63633922c61c92375c9c074a93e85963554f5499fe1450d0e5\n2020-06-05 18:10:19.944 +08:00 NetworkRuntime INFO ckb-network  p2p service event: ListenStarted { address: "/ip4/0.0.0.0/tcp/8115" }\n2020-06-05 18:10:19.946 +08:00 NetworkRuntime INFO ckb-network  Listen on address: /ip4/0.0.0.0/tcp/8115/p2p/QmWKGXVhYx2T8YmbsC1RYjnrRf1hfz2ZNTMywrkN9y2bVg\n2020-06-05 18:10:19.951 +08:00 main INFO ckb-db  Initialize a new database\n2020-06-05 18:10:19.983 +08:00 main INFO ckb-db  Init database version 20191201091330\n2020-06-05 18:10:20.146 +08:00 NetworkRuntime INFO ckb-relay  RelayProtocol(1).connected peer=SessionId(1)\n2020-06-05 18:10:20.146 +08:00 NetworkRuntime INFO ckb-sync  SyncProtocol.connected peer=SessionId(1)\n2020-06-05 18:10:20.451 +08:00 NetworkRuntime INFO ckb-sync  Ignoring getheaders from peer=SessionId(1) because node is in initial block download\n2020-06-05 18:10:20.749 +08:00 ChainService INFO ckb-chain  block: 1, hash: 0x2567f226c73b04a6cb3ef04b3bb10ab99f37850794cd9569be7de00bac4db875, epoch: 0(1/1743), total_diff: 0x3b1bb3d4c1376a, txs:1\n'))),(0,r.kt)("h2",{id:"run-a-public-rpc-node"},"Run a Public RPC Node"),(0,r.kt)("p",null,"CKB nodes have built-in RPC functionality, which becomes available as soon as the node is started."),(0,r.kt)("p",null,"RPC is private by default. Exposing RPC through the ",(0,r.kt)("inlineCode",{parentName:"p"},"rpc.listen_address")," configuration option allows arbitrary machines to access the JSON-RPC port, posing a security risk. Therefore, it is strongly discouraged. "),(0,r.kt)("p",null,"However, if you have to expose them, make sure to strictly limit the access to trusted machines only, by following the method below."),(0,r.kt)("h3",{id:"rpc-access-control"},"RPC Access Control"),(0,r.kt)("p",null,"Here is an example to use Nginx API Gateway to configure the RPC access control. Explore more solutions or submit new ones using the GitHub tag ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/topics/ckb-rpc-proxy"},"ckb-rpc-proxy"),"."),(0,r.kt)("p",null,"Step 1: Install Docker-Compose and Docker"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"apt install docker-compose\napt install docker\n")),(0,r.kt)("p",null,"Step 2: Clone Code"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"git clone https://github.com/cryptape/ckb-nginx-proxy.git\n")),(0,r.kt)("p",null,"Step 3: Replace Default Value With Your CKB RPC Address"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},'cd ckb-nginx-proxy\n\nsed -i "s/YOUR_CKR_RPC_IP:8114/192.168.1.100:8114/" nginx.conf\n')),(0,r.kt)("p",null,"Step 4: Run Proxy"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"docker-compose up -d\n")),(0,r.kt)("h3",{id:"example"},"Example"),(0,r.kt)("p",null,"Get tip block hash and number:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'echo \'{\n    "id": 2,\n    "jsonrpc": "2.0",\n    "method": "get_tip_header",\n    "params": []\n}\' \\\n| tr -d \'\\n\' \\\n| curl -H \'content-type: application/json\' -d @- \\\nhttp://192.168.1.100:80\n\n// Note that http://192.168.1.100:80 needs to be changed to your proxy IP!\n')),(0,r.kt)("p",null,"Result:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'{\n    "jsonrpc": "2.0",\n    "result": {\n        "compact_target": "0x1d090fbe",\n        "dao": "0xba17553fab3db84154bc4aa9f09b2600e826a2b0df99010400ed51b4686b5808",\n        "epoch": "0x7080687001539",\n        "extra_hash": "0x0000000000000000000000000000000000000000000000000000000000000000",\n        "hash": "0x7a46e779a3fc2d5b55c82aad852e721b0097bf873927b9751409b1d185599ce4",\n        "nonce": "0xd265e70dfd205dbbed33b29294121856",\n        "number": "0x7037f2",\n        "parent_hash": "0x3d105fe9ec60f138baa6623abd16af70ba1be90ad23d1943bcaa55d5f14fcb6f",\n        "proposals_hash": "0x2581d1769886226a8c90ee99baf2d8696e24c7f6bb6751748ff8b4452f8006e5",\n        "timestamp": "0x1847a2bfad2",\n        "transactions_root": "0x28157a5962c4ae1d3e153b1d8d331e5fd3c158866287f5398ab7f7d38210dfb0",\n        "version": "0x0"\n    },\n    "id": 2\n}\n')),(0,r.kt)("p",null,"Execute ",(0,r.kt)("inlineCode",{parentName:"p"},"clear_tx_pool"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},'echo \'{\n    "id": 2,\n    "jsonrpc": "2.0",\n    "method": "clear_tx_pool",\n    "params": []\n}\' | tr -d \'\\n\' | curl -H \'content-type: application/json\' -d @- \\\nhttp://192.168.1.100:80\n')),(0,r.kt)("p",null,"Result:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"This method has been banned\n")),(0,r.kt)("h3",{id:"list-of-restricted-methods"},"List of Restricted Methods"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"clear_banned_addresses\nset_ban\nset_network_active\nadd_node\nremove_node\nremove_transaction\nclear_tx_pool\n")))}m.isMDXComponent=!0}}]);